let usuario,pin,saldo,saldoRetirar,accion="",numeroAcciones=0;function iniciarApp(){mostrarSecciones(),validarFormulario(),validarPin(),login(),consultarSaldo(),retirar(),SolicitarCantidadRetirar(),aceptarRetiro(),depositar(),SolicitarCantidadDepositar(),aceptarDeposito(),transferirCuenta(),loginTransferir(),SolicitarCantidadTransferir(),aceptarTransferencia(),cambiarPin(),loginCambiarPin(),ImprimirEstadoCuenta(),cerrarSesion(),regresar(),RegresarRetirar(),RegresarDepositar(),regresarTransferir(),regresarTransferirLogin(),regresarLoginCambiarPin(),regresarCambiarPin(),regresarEstadoCuenta(),mostrarSeccionesAdmi(),loginAdministrador(),crearCuenta(),validarInputs(),eliminarCuenta(),validarEliminar(),modificarCuenta(),validarCuentaModificar(),validarModificar(),cerrarSesionAdministrador(),regresarCrear(),aceptarCuentaCreada(),regresarEliminar(),aceptarCuentaEliminada(),regresarModificar1(),regresarModificar(),aceptarCuentaModificada()}function mostrarSecciones(){document.querySelector("#ingresar-cliente").addEventListener("click",(function(e){e.preventDefault();const r=document.querySelector("#administrativo"),o=document.querySelector("#cliente");r.classList.add("ocultar-seccion"),o.classList.remove("ocultar-seccion")}))}function validarFormulario(){document.querySelector("#iniciar-administrativo").addEventListener("click",e=>{e.preventDefault();const r=document.querySelector("#cuenta");""!==document.querySelector("#password-administrativo").value&&""!==r.value||mostrarAlerta("Debe rellenar todos los campos","error",1)});document.querySelector("#iniciar-sesion").addEventListener("click",e=>{e.preventDefault();const r=document.querySelector("#numero-tarjeta"),o=document.querySelector("#pin");""!==r.value&&""!==o.value||mostrarAlerta("Debe rellenar todos los campos","error",0)})}function validarPin(){document.querySelector("#pin").addEventListener("input",e=>{(e.target.value.length>4||e.target.value.length<4)&&mostrarAlerta("El tamaño del pin debe de ser de 4 digítos","error",0)})}function mostrarAlerta(e,r,o){if(document.querySelector(".alerta"))return;const a=document.createElement("DIV");if(a.textContent=e,a.classList.add("alerta"),"error"===r&&a.classList.add("error"),1==o){document.querySelector("#formulario-alerta").appendChild(a)}else if(2==o){document.querySelector("#formulario-transferir").appendChild(a)}else{document.querySelector("#formulario-alerta2").appendChild(a)}setTimeout(()=>{a.remove()},3e3)}function login(){document.querySelector("#iniciar-sesion").addEventListener("click",(function(e){usuario=document.querySelector("#numero-tarjeta").value,pin=document.querySelector("#pin").value,ConectarAjaxCuenta()}))}function ConectarAjaxCuenta(){const e=new XMLHttpRequest;e.open("GET","Controlador/login/cuenta.php",!0),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){JSON.parse(this.responseText).forEach(e=>{if(e.pin==pin&&e.NumeroTarjeta==usuario){saldo=e.saldo;document.querySelector("#cliente").classList.add("ocultar-seccion");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion")}else mostrarAlerta("Error en la autentificación","error",0)})}},e.send()}function cerrarSesion(){document.querySelector("#cerrar-sesion").addEventListener("click",(function(){document.querySelector("#administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.remove("ocultar-seccion"),document.querySelector("#numero-tarjeta").value=null,document.querySelector("#pin").value=null,document.querySelector("#cuenta").value=null,console.log(numeroAcciones),0!=numeroAcciones&&(tablaPivote(),numeroAcciones=0)}))}function consultarSaldo(){document.querySelector("#consultar-saldo").addEventListener("click",(function(){ConectarAjaxCuentaConsulta(),accion="'Efectuó una consulta de saldo'",añadirAccion(),numeroAcciones++}))}function ConectarAjaxCuentaConsulta(){const e=new XMLHttpRequest;e.open("GET","Controlador/consultaSaldo/consulta.php",!0),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);console.log(e),e.forEach(e=>{if(e.pin==pin&&e.NumeroTarjeta==usuario){const r=document.querySelector("#seccion-consultar");r.classList.remove("ocultar-seccion");document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#contenedor-bottonRegresar").classList.remove("ocultar-seccion");const o=e.nombre,a=e.apellido_paterno,t=e.apellido_materno,n=e.FechaExpiracion;saldo=e.saldo;const i=document.createElement("P"),c=document.createElement("P"),s=document.createElement("P"),l=document.querySelector(".contenedor-consulta");l&&l.remove();const d=document.createElement("DIV");d.classList.add("contenedor-consulta"),i.innerHTML=`Buen día ${o} ${a} ${t}`,d.appendChild(i),c.innerHTML=` Su saldo es de <span> $ ${saldo}</span>`,d.appendChild(c),s.innerHTML=`Le recordamos que su tarjeta  <span>${usuario}</span> expira el <span>${n}</span>`,d.appendChild(s),r.appendChild(d)}})}},e.send()}function regresar(){document.querySelector("#regresar").addEventListener("click",(function(){document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion");document.querySelector("#seccion-consultar").classList.add("ocultar-seccion");document.querySelector("#contenedor-bottonRegresar").classList.add("ocultar-seccion")}))}function retirar(){document.querySelector("#retirar").addEventListener("click",(function(){document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#contenedor-bottonRetirar").classList.remove("ocultar-seccion");document.querySelector("#contenedor-retirar").classList.remove("ocultar-seccion");document.querySelector("#contenedor-aceptar").classList.remove("ocultar-seccion");document.querySelector("#contenedor-mensajeRetirar").classList.remove("ocultar-seccion")}))}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));let pintarCuadro=document.querySelector("#menu-retirar"),otraCantidad=document.querySelector("#OtraCantidad-retirar");function SolicitarCantidadRetirar(){document.querySelector("#menu-retirar").addEventListener("click",e=>{pintarCuadro.classList.contains("pintar-cuadro")&&pintarCuadro.classList.remove("pintar-cuadro"),"OtraCantidad-retirar"!=pintarCuadro.id&&(document.querySelector("#OtraCantidad-retirar").value=null),"menu-retirar"==pintarCuadro.id&&pintarCuadro.classList.add("pintar-negro"),console.log(e.target.id),pintarCuadro=document.querySelector("#"+e.target.id),pintarCuadro.classList.add("pintar-cuadro"),saldoRetirar=parseInt(e.target.value),console.log(saldoRetirar)})}let saldoDepositar,usuarioTransferir,saldoCuentaTransferir,saldoTransferir,tipoRetiro="Exitoso",operacion="";function aceptarRetiro(){document.querySelector("#aceptar-retiro").addEventListener("click",()=>{if(pintarCuadro.classList.remove("pintar-cuadro"),console.log("El saldo es:"+saldo),saldo>=saldoRetirar){tipoRetiro="Exitoso",operacion="retiro";const e=saldo-saldoRetirar;console.log(e),actualizarSaldo(e),accion="'Efectuó un retiro a su cuenta'",añadirAccion(),numeroAcciones++}else tipoRetiro="error",mensajeRetirar()})}function actualizarSaldo(e){xhtpp=new XMLHttpRequest,usuario=parseInt(usuario),xhtpp.open("GET","Controlador/actualizarSaldo/actualizarSaldo.php?nuevoSaldo="+e+"&usuario="+usuario,!0),xhtpp.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);saldo=parseInt(e[0].saldo),document.querySelector("#OtraCantidad-retirar").value=null,document.querySelector("#OtraCantidad-depositar").value=null,"retiro"==operacion?mensajeRetirar():mensajeDepositar(),otraCantidad.value=NaN}},xhtpp.send()}function mensajeRetirar(){console.log("hecho");const e=document.querySelector("#contenedor-mensajeRetirar"),r=document.createElement("P");let o="";console.log(tipoRetiro),"error"==tipoRetiro?(o="No cuenta con fondos suficientes para efectuar esa operacion",r.classList.add("mensajeNoRetirar")):(o="Su retiro se ha realizado correctamente, su nuevo saldo es: "+saldo,r.classList.add("mensajeRetirar")),r.textContent=o,e.appendChild(r),setTimeout(()=>{r.remove()},3e3)}function RegresarRetirar(){document.querySelector("#contenedor-bottonRetirar").addEventListener("click",(function(){document.querySelector("#OtraCantidad-retirar").value=NaN,pintarCuadro.classList.remove("pintar-cuadro");document.querySelector("#contenedor-bottonRetirar").classList.add("ocultar-seccion");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion");document.querySelector("#contenedor-retirar").classList.add("ocultar-seccion");document.querySelector("#contenedor-aceptar").classList.add("ocultar-seccion");document.querySelector("#contenedor-mensajeRetirar").classList.add("ocultar-seccion")}))}function depositar(){document.querySelector("#depositar").addEventListener("click",(function(){document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#contenedor-bottonDepositar").classList.remove("ocultar-seccion");document.querySelector("#contenedor-depositar").classList.remove("ocultar-seccion");document.querySelector("#contenedor-aceptarDeposito").classList.remove("ocultar-seccion");document.querySelector("#contenedor-mensajeDepositar").classList.remove("ocultar-seccion")}))}function SolicitarCantidadDepositar(){document.querySelector("#menu-depositar").addEventListener("click",e=>{pintarCuadro.classList.contains("pintar-cuadro")&&pintarCuadro.classList.remove("pintar-cuadro"),"OtraCantidad-depositar"!=pintarCuadro.id&&(document.querySelector("#OtraCantidad-depositar").value=null),"menu-depositar"==pintarCuadro.id&&pintarCuadro.classList.add("pintar-negro"),console.log(e.target.id),pintarCuadro=document.querySelector("#"+e.target.id),pintarCuadro.classList.add("pintar-cuadro"),saldoDepositar=parseInt(e.target.value),console.log(saldoDepositar)})}function aceptarDeposito(){document.querySelector("#aceptar-deposito").addEventListener("click",()=>{pintarCuadro.classList.remove("pintar-cuadro"),saldo=parseInt(saldo),console.log("El saldo es:"+saldo);const e=saldo+saldoDepositar;console.log(e),operacion="deposito",actualizarSaldo(e),accion="'Efectuó un deposito a su cuenta'",añadirAccion(),numeroAcciones++})}function mensajeDepositar(){console.log("hecho");const e=document.querySelector("#contenedor-mensajeDepositar"),r=document.createElement("P"),o="Su deposito se ha realizado correctamente, su nuevo saldo es: "+saldo;r.classList.add("mensajeDepositar"),r.textContent=o,e.appendChild(r),setTimeout(()=>{r.remove()},3e3)}function RegresarDepositar(){document.querySelector("#contenedor-bottonDepositar").addEventListener("click",(function(){document.querySelector("#OtraCantidad-depositar").value=null,pintarCuadro.classList.remove("pintar-cuadro");document.querySelector("#contenedor-bottonDepositar").classList.add("ocultar-seccion");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion");document.querySelector("#contenedor-depositar").classList.add("ocultar-seccion");document.querySelector("#contenedor-aceptarDeposito").classList.add("ocultar-seccion");document.querySelector("#contenedor-mensajeDepositar").classList.add("ocultar-seccion")}))}function transferirCuenta(){document.querySelector("#transferir-cuenta").addEventListener("click",()=>{document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#formulario-transferir").classList.remove("ocultar-seccion")})}function regresarTransferir(){document.querySelector("#regresar-transferir").addEventListener("click",(function(){console.log("hecho");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion");document.querySelector("#formulario-transferir").classList.add("ocultar-seccion"),document.querySelector("#numero-tarjetaTransferir").value=null}))}function loginTransferir(){document.querySelector("#aceptar-transferencia").addEventListener("click",(function(e){e.preventDefault(),usuarioTransferir=document.querySelector("#numero-tarjetaTransferir").value;const r=new XMLHttpRequest;r.open("GET","Controlador/transferir/transferirCuenta.php",!0),r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);console.log(e),e.forEach(e=>{if(e.NumeroTarjeta==usuarioTransferir&&e.NumeroTarjeta!=usuario){saldoCuentaTransferir=e.saldo;document.querySelector("#formulario-transferir").classList.add("ocultar-seccion");document.querySelector("#contenedor-transferir").classList.remove("ocultar-seccion");document.querySelector("#contenedor-mensajeTransferir").classList.remove("ocultar-seccion");document.querySelector("#contenedor-aceptarTransferencia").classList.remove("ocultar-seccion");document.querySelector("#contenedor-bottonRegresarTransferir").classList.remove("ocultar-seccion")}else mostrarAlerta("Error en la autentificación","error",2)})}},r.send()}))}function SolicitarCantidadTransferir(){document.querySelector("#menu-transferir").addEventListener("click",e=>{pintarCuadro.classList.contains("pintar-cuadro")&&pintarCuadro.classList.remove("pintar-cuadro"),"OtraCantidad-transferir"!=pintarCuadro.id&&(otraCantidad.value=null),"menu-transferir"==pintarCuadro.id&&pintarCuadro.classList.add("pintar-negro"),console.log(e.target.id),pintarCuadro=document.querySelector("#"+e.target.id),pintarCuadro.classList.add("pintar-cuadro"),saldoTransferir=parseInt(e.target.value),console.log(saldoTransferir)})}pintarCuadro=document.querySelector("#menu-depositar"),otraCantidad=document.querySelector("#OtraCantidad-depositar"),pintarCuadro=document.querySelector("#menu-transferir"),otraCantidad=document.querySelector("#OtraCantidad-transferir");let pin2,tipoTransferencia="";function aceptarTransferencia(){document.querySelector("#aceptar-transferenciaMenu").addEventListener("click",()=>{if(pintarCuadro.classList.remove("pintar-cuadro"),saldoCuentaTransferir=parseInt(saldoCuentaTransferir),saldo>=saldoTransferir){let e=saldo-saldoTransferir,r=saldoCuentaTransferir+saldoTransferir;e=parseInt(e),r=parseInt(r),operacion="transferencia",actualizarSaldoTransferencia(r),actualizarSaldo(e),accion="'Efectuó una transferencia'",añadirAccion(),numeroAcciones++}else tipoTransferencia="error",mensajeTransferir()})}function actualizarSaldoTransferencia(e){xhtpp=new XMLHttpRequest,usuarioTransferir=parseInt(usuarioTransferir),xhtpp.open("GET","Controlador/actualizarSaldo/actualizarSaldo.php?nuevoSaldo="+e+"&usuario="+usuarioTransferir,!0),xhtpp.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);saldoCuentaTransferir=parseInt(e[0].saldo),"retiro"==operacion?mensajeRetirar():"deposito"==operacion?mensajeDepositar():"transferencia"==operacion&&mensajeTransferir(),otraCantidad.value=NaN}},xhtpp.send()}function mensajeTransferir(){const e=document.querySelector("#contenedor-mensajeTransferir"),r=document.createElement("P");let o="";"error"==tipoTransferencia?(o="No cuenta con fondos suficientes para efectuar esa operacion",r.classList.add("mensajeNoTransferir")):(o="Su transferencia se ha realizado correctamente",r.classList.add("mensajeTransferir")),r.textContent=o,e.appendChild(r),setTimeout(()=>{r.remove()},3e3)}function regresarTransferirLogin(){document.querySelector("#contenedor-bottonRegresarTransferir").addEventListener("click",(function(){otraCantidad.value=NaN,pintarCuadro.classList.remove("pintar-cuadro");document.querySelector("#contenedor-bottonRegresarTransferir").classList.add("ocultar-seccion");document.querySelector("#formulario-transferir").classList.remove("ocultar-seccion");document.querySelector("#contenedor-transferir").classList.add("ocultar-seccion");document.querySelector("#contenedor-aceptarTransferencia").classList.add("ocultar-seccion");document.querySelector("#contenedor-mensajeTransferir").classList.add("ocultar-seccion"),document.querySelector("#OtraCantidad-transferir").value=null,document.querySelector("#numero-tarjetaTransferir").value=null}))}function cambiarPin(){document.querySelector("#cambiar-pin").addEventListener("click",(function(){document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#formulario-pin").classList.remove("ocultar-seccion")}))}let usuarioAdministrativo,password,administradorId,tipoCambio="";function loginCambiarPin(){document.querySelector("#aceptar-cambio-pin").addEventListener("click",(function(e){if(e.preventDefault(),pin2=document.querySelector("#numero-pin").value,pin==pin2){document.querySelector("#formulario-pin").classList.add("ocultar-seccion");document.querySelector("#formulario-pin-2").classList.remove("ocultar-seccion"),document.querySelector("#aceptar-cambio-pin-2").addEventListener("click",(function(e){e.preventDefault();const r=document.querySelector("#numero-pin-2").value;r.length<4||r.length>4?(tipoCambio="tamaño",mensajeCambiarPin()):(accion="'Cambio de PIN'",añadirAccion(),numeroAcciones++,ConectarAjaxCambiarPin(r))}))}else tipoCambio="error",mensajeCambiarPin()}))}function mensajeCambiarPin(){const e=document.createElement("P");let r="";if("error"==tipoCambio){const o=document.querySelector("#contenedor-mensajeCambiarPin");r="El PIN introducido es incorrecto",e.classList.add("mensajeNoCambiarPin"),e.textContent=r,o.appendChild(e)}else if("exitoso"==tipoCambio){const o=document.querySelector("#contenedor-mensajeCambiarPin2");r="Su PIN ha sido modificado correctamente, su nuevo pin es: "+pin,e.classList.add("mensajeCambiarPin"),e.textContent=r,o.appendChild(e)}else{const o=document.querySelector("#contenedor-mensajeCambiarPin2");r="El tamaño del pin debe ser de 4 digítos",e.classList.add("mensajeNoCambiarPin"),e.textContent=r,o.appendChild(e)}setTimeout(()=>{e.remove()},3e3)}function ConectarAjaxCambiarPin(e){const r=new XMLHttpRequest;r.open("GET","Controlador/cambiarPin/actualizarPin.php?nuevoPin="+e+"&usuario="+usuario,!0),r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);console.log(e),pin=parseInt(e[0].pin),tipoCambio="exitoso",document.querySelector("#numero-pin-2").value=null,mensajeCambiarPin()}},r.send()}function regresarLoginCambiarPin(){document.querySelector("#regresar-pin-2").addEventListener("click",(function(){document.querySelector("#formulario-pin-2").classList.add("ocultar-seccion");document.querySelector("#formulario-pin").classList.remove("ocultar-seccion"),document.querySelector("#numero-pin").value=null}))}function regresarCambiarPin(){document.querySelector("#regresar-pin").addEventListener("click",(function(){document.querySelector("#formulario-pin").classList.add("ocultar-seccion");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion"),document.querySelector("#numero-pin").value=null}))}function ImprimirEstadoCuenta(){document.querySelector("#imprimir-estado").addEventListener("click",(function(e){e.preventDefault();document.querySelector("#contenedor-menu").classList.add("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#estado-cuenta").classList.remove("ocultar-seccion"),accion="'Consultó su estado cuenta'",añadirAccion(),numeroAcciones++,console.log(numeroAcciones),tablaPivote(),numeroAcciones=0,joinTablas()}))}function regresarEstadoCuenta(){document.querySelector("#regresar-estado").addEventListener("click",(function(){document.querySelector("#estado-cuenta").classList.add("ocultar-seccion");document.querySelector("#contenedor-menu").classList.remove("ocultar-seccion")}))}function añadirAccion(){const e=new XMLHttpRequest;console.log("Accion añadida"),e.open("GET","Controlador/estadoCuenta/almacenarAcciones.php?accion="+accion,!0),e.onreadystatechange=function(){4==this.readyState&&this.status},e.send()}function tablaPivote(){const e=new XMLHttpRequest;console.log("Se crea tabla Pivote"),e.open("GET","Controlador/estadoCuenta/tablaPivote.php?usuario="+usuario+"&numeroAcciones="+numeroAcciones,!0),e.onreadystatechange=function(){4==this.readyState&&this.status},e.send()}function joinTablas(){const e=new XMLHttpRequest;console.log("Se unen tablas"),e.open("GET","Controlador/estadoCuenta/joinTablas.php",!0),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){JSON.parse(this.responseText).forEach(e=>{if(e.NumeroTarjeta==usuario){const r=document.querySelector(".contenedor-consulta");r&&r.remove();const o=e.nombre,a=e.apellido_paterno,t=e.apellido_materno,n=e.FechaExpiracion,i=document.createElement("P"),c=document.createElement("P"),s=document.createElement("DIV");s.classList.add("contenedor-consulta"),i.innerHTML=`Buen día ${o} ${a} ${t}`,s.appendChild(i),c.innerHTML=`Le recordamos que su tarjeta  <span>${usuario}</span> expira el <span>${n}</span>`,s.appendChild(c);document.querySelector("#seccion-cuenta-consultar").appendChild(s);const l=document.createElement("UL");l.classList.add("contenedor-operaciones");const d=document.createElement("LI");d.innerHTML="<span class='fecha'>"+e.fecha+"</span> -> "+e.accion,l.appendChild(d);document.querySelector("#acciones").appendChild(l),document.querySelector("#regresar-estado").addEventListener("click",()=>{l.remove()})}})}},e.send()}function mostrarSeccionesAdmi(){document.querySelector("#seccion-admi").addEventListener("click",(function(e){e.preventDefault();document.querySelector("#cliente").classList.add("ocultar-seccion");document.querySelector("#administrativo").classList.remove("ocultar-seccion")}))}function loginAdministrador(){document.querySelector("#iniciar-administrativo").addEventListener("click",e=>{usuarioAdministrativo=document.querySelector("#cuenta").value,password=document.querySelector("#password-administrativo").value,ConectarAjaxAdministrador()})}function ConectarAjaxAdministrador(){const e=new XMLHttpRequest;e.open("GET","Controlador/loginAdministrador/loginAdministrador.php",!0),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){JSON.parse(this.responseText).forEach(e=>{if(e.password==password&&e.nombre==usuarioAdministrativo){administradorId=e.id;document.querySelector("#administrativo").classList.add("ocultar-seccion");document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#heading").classList.add("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion")}else mostrarAlerta("Error en la autentificación","error",1)})}},e.send()}function cerrarSesionAdministrador(){document.querySelector("#contenedor-botton").addEventListener("click",e=>{console.log("listo"),e.preventDefault();document.querySelector("#operaciones-administrativo").classList.add("ocultar-seccion");document.querySelector("#contenedor-botton").classList.add("ocultar-seccion");document.querySelector("#administrativo").classList.remove("ocultar-seccion");document.querySelector("#heading").classList.remove("ocultar-seccion"),document.querySelector("#cuenta").value=null,document.querySelector("#password-administrativo").value=null})}function crearCuenta(){document.querySelector("#crear").addEventListener("click",(function(){document.querySelector("#operaciones-administrativo").classList.add("ocultar-seccion");document.querySelector("#contenedor-botton").classList.add("ocultar-seccion");document.querySelector("#contenedor-crear").classList.remove("ocultar-seccion")}))}let numeroTarjetaCrear,nombre,apellidoPaternoCrear,apellidoMaternoCrear,fechaExpiracionCrear,pinCrear,saldoCrear,clienteId,contenedorCrear,usuarioEliminar,nombreEliminar,apellidoPaternoEliminar,apellidoMaternoEliminar,tipomensaje="",tipoErrorCrear="";function validarInputs(){document.querySelector("#aceptar-crear").addEventListener("click",e=>{if(e.preventDefault(),console.log("listo"),nombre=document.querySelector("#nombre-crear").value,apellidoPaternoCrear=document.querySelector("#apellidoP-crear").value,apellidoMaternoCrear=document.querySelector("#apellidoM-crear").value,numeroTarjetaCrear=document.querySelector("#numero-tarjeta-crear").value,fechaExpiracionCrear=document.querySelector("#fecha-crear").value,pinCrear=document.querySelector("#pin-crear").value,saldoCrear=document.querySelector("#saldo-crear").value,obtenerClienteId(),""==nombre||""==apellidoPaternoCrear||""==apellidoMaternoCrear||""==numeroTarjetaCrear||""==fechaExpiracionCrear||""==pinCrear||""==saldoCrear)tipomensaje="error",tipoErrorCrear="campos",alertaInputs();else if(pinCrear.length>4||pinCrear.length<4)tipomensaje="error",tipoErrorCrear="pin",alertaInputs();else if(numeroTarjetaCrear.length<9||numeroTarjetaCrear.length>9)tipomensaje="error",tipoErrorCrear="numero-tarjeta",alertaInputs();else if("numero-repetido"!==tipoErrorCrear&&(conectarAjaxValidarNumero(),"numero-repetido"!==tipoErrorCrear)){llenarTablas();document.querySelector("#contenedor-crear").classList.add("ocultar-seccion");document.querySelector("#cuenta-creada").classList.remove("ocultar-seccion");const e=document.querySelector("#contenedor-parrafo-cuenta");contenedorCrear=document.createElement("DIV");const r=document.createElement("P"),o=clienteId.toString();r.innerHTML=`Para el clienteId -> ${o} <br> Se ha creado exitosamente la cuenta ->\n                                    <span>${nombre} ${apellidoPaternoCrear} ${apellidoMaternoCrear}</span> <br> \n                                    con numero  -> <span>${numeroTarjetaCrear}</span>, \n                                    fecha de expiración-><span>${fechaExpiracionCrear}</span>\n                                    <br> y un saldo inicial -> $${saldoCrear}`,contenedorCrear.appendChild(r),e.appendChild(contenedorCrear)}tipoErrorCrear=""})}function obtenerClienteId(){const e=new XMLHttpRequest;e.open("GET","Controlador/crearCuenta/obtenerClienteId.php",!1),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);clienteId=e[e.length-1].id,clienteId=parseInt(clienteId)+1,console.log(clienteId)}},e.send()}function alertaInputs(){const e=document.createElement("DIV");e.classList.add("contenedor-mensaje");const r=document.createElement("P");"error"==tipomensaje&&"campos"==tipoErrorCrear?(r.textContent="Debe rellenar todos los campos",r.classList.add("no-crear")):"error"==tipomensaje&&"pin"==tipoErrorCrear?(r.textContent="El pin debe de ser de 4 dígitos",r.classList.add("no-crear")):"error"==tipomensaje&&"numero-tarjeta"==tipoErrorCrear?(r.textContent="El número de tarjeta debe de ser de 9 dígitos",r.classList.add("no-crear")):"error"==tipomensaje&&"numero-repetido"==tipoErrorCrear&&(r.textContent="Ese número de tarjeta ya existe",r.classList.add("no-crear")),e.appendChild(r);document.querySelector("#mensaje-crear").appendChild(e),setTimeout(()=>{e.remove()},3e3)}function conectarAjaxValidarNumero(){const e=new XMLHttpRequest;e.open("GET","Controlador/crearCuenta/validarNumero.php",!1),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);console.log(e),e.forEach(e=>{e.NumeroTarjeta==numeroTarjetaCrear&&(tipomensaje="error",tipoErrorCrear="numero-repetido",tipoErrorModificar="numero-repetido",alertaInputs(),alertaModificar())})}},e.send()}function llenarTablas(){nombre=`'${nombre}'`,apellidoPaternoCrear=`'${apellidoPaternoCrear}'`,apellidoMaternoCrear=`'${apellidoMaternoCrear}'`;for(let e=0;e<2;e++)fechaExpiracionCrear=fechaExpiracionCrear.replace("-","/");fechaExpiracionCrear=`'${fechaExpiracionCrear}'`,console.log(fechaExpiracionCrear),clienteId=clienteId.toString(),console.log(clienteId),console.log(administradorId),console.log(numeroTarjetaCrear),console.log(pinCrear),console.log(saldoCrear);const e=new XMLHttpRequest;e.open("GET","Controlador/crearCuenta/crearCuenta.php?NumeroTarjeta="+numeroTarjetaCrear+"&pin="+pinCrear+"&FechaExpiracion="+fechaExpiracionCrear+"&saldo="+saldoCrear+"&clienteId="+clienteId+"&administradorId="+administradorId+"&nombre="+nombre+"&apellido_paterno="+apellidoPaternoCrear+"&apellido_materno="+apellidoMaternoCrear,!0),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&console.log("Datos enviados")},e.send()}function aceptarCuentaCreada(){document.querySelector("#botton-aceptar").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#cuenta-creada").classList.add("ocultar-seccion"),contenedorCrear.remove(),document.querySelector("#numero-tarjeta-crear").value=null,document.querySelector("#nombre-crear").value=null,document.querySelector("#apellidoP-crear").value=null,document.querySelector("#apellidoM-crear").value=null,document.querySelector("#pin-crear").value=null,document.querySelector("#saldo-crear").value=null,document.querySelector("#fecha-crear").value=null})}function regresarCrear(){document.querySelector("#regresar-menuCrear").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#contenedor-crear").classList.add("ocultar-seccion"),document.querySelector("#numero-tarjeta-crear").value=null,document.querySelector("#nombre-crear").value=null,document.querySelector("#apellidoP-crear").value=null,document.querySelector("#apellidoM-crear").value=null,document.querySelector("#pin-crear").value=null,document.querySelector("#saldo-crear").value=null,document.querySelector("#fecha-crear").value=null})}function eliminarCuenta(){document.querySelector("#eliminar").addEventListener("click",(function(){document.querySelector("#operaciones-administrativo").classList.add("ocultar-seccion");document.querySelector("#contenedor-botton").classList.add("ocultar-seccion");document.querySelector("#contenedor-eliminar").classList.remove("ocultar-seccion")}))}let mensajeEliminar,clienteIdEliminar,contenedorCuentaEliminada,numeroTarjetaModificar1,pinModificar1,tipomensajeModificar1,tipoErrorModificar1,tipoEliminar="",correcto="";function validarEliminar(){document.querySelector("#aceptar-eliminar").addEventListener("click",e=>{if(e.preventDefault(),usuarioEliminar=document.querySelector("#numero-tarjeta-eliminar").value,nombreEliminar=document.querySelector("#nombre-eliminar").value,apellidoPaternoEliminar=document.querySelector("#apellidoP-eliminar").value,apellidoMaternoEliminar=document.querySelector("#apellidoM-eliminar").value,""==nombreEliminar||""==apellidoPaternoEliminar||""==apellidoMaternoEliminar||""==usuarioEliminar)tipoEliminar="vacios",alertaEliminar();else if(usuarioEliminar.length<9||usuarioEliminar.length>9)tipoEliminar="numero-tarjeta",alertaEliminar();else if("datos"!=tipoEliminar&&"administrador"!=tipoEliminar)if(ConectarAjaxValidarEliminar(),"exito"==correcto){console.log("Todo bien");document.querySelector("#cuenta-eliminada").classList.remove("ocultar-seccion");document.querySelector("#contenedor-eliminar").classList.add("ocultar-seccion");const e=document.querySelector("#contenedor-parrafo-cuentaEliminada");contenedorCuentaEliminada=document.createElement("DIV");const r=clienteId.toString(),o=document.createElement("P");o.innerHTML=`Para el clienteId -> ${r} <br> \n                                        <span> ${nombreEliminar} ${apellidoPaternoEliminar} ${apellidoMaternoEliminar}</span> <br> \n                                        con numero  -> <span>${usuarioEliminar}</span><br><br>\n                                            <span class="resaltar">¿Desea Eliminar la cuenta? </span>`,contenedorCuentaEliminada.appendChild(o),e.appendChild(contenedorCuentaEliminada)}else alertaEliminar();tipoEliminar="",correcto=""})}function ConectarAjaxValidarEliminar(){const e=new XMLHttpRequest;e.open("GET","Controlador/eliminarCuenta/validarCuenta.php",!1),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("Conecta con base de datos");JSON.parse(this.responseText).forEach(e=>{usuarioEliminar==e.NumeroTarjeta&&nombreEliminar==e.nombre&&apellidoPaternoEliminar==e.apellido_paterno&&apellidoMaternoEliminar==e.apellido_materno?(correcto="exito",clienteId=e.clienteId):usuarioEliminar!=e.NumeroTarjeta||nombreEliminar!=e.nombre||apellidoPaternoEliminar!=e.apellido_paterno||apellidoMaternoEliminar!=e.apellido_materno?tipoEliminar="datos":e.admnistradorId!=administradorId&&(tipoEliminar="administrador")})}},e.send()}function alertaEliminar(){const e=document.createElement("DIV");e.classList.add("contenedor-mensaje");const r=document.createElement("P");"vacios"==tipoEliminar?(r.textContent="Debe rellenar todos los campos",r.classList.add("no-crear")):"numero-tarjeta"==tipoEliminar?(r.textContent="El número de tarjeta debe de ser de 9 dígitos",r.classList.add("no-crear")):"datos"==tipoEliminar?(r.textContent="Los datos ingresado no pertenecen a ninguna cuenta",r.classList.add("no-crear")):"administrador"==tipoEliminar&&(r.textContent="El administrador no tiene permiso de eliminar esa cuenta",r.classList.add("no-crear")),e.appendChild(r);document.querySelector("#mensaje-eliminar").appendChild(e),setTimeout(()=>{e.remove()},3e3)}function aceptarCuentaEliminada(){document.querySelector("#botton-aceptarEliminar").addEventListener("click",e=>{e.preventDefault(),aplicarDelete();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#cuenta-eliminada").classList.add("ocultar-seccion"),contenedorCuentaEliminada.remove(),document.querySelector("#numero-tarjeta-eliminar").value=null,document.querySelector("#nombre-eliminar").value=null,document.querySelector("#apellidoP-eliminar").value=null,document.querySelector("#apellidoM-eliminar").value=null})}function regresarEliminar(){document.querySelector("#regresar-menu-eliminar").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#contenedor-eliminar").classList.add("ocultar-seccion"),document.querySelector("#numero-tarjeta-eliminar").value=null,document.querySelector("#nombre-eliminar").value=null,document.querySelector("#apellidoP-eliminar").value=null,document.querySelector("#apellidoM-eliminar").value=null})}function aplicarDelete(){const e=new XMLHttpRequest;e.open("GET","Controlador/eliminarCuenta/aplicarDelete.php?clienteId="+clienteId,!0),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&alert("La cuenta ha sido eliminada")},e.send()}function modificarCuenta(){document.querySelector("#modificar").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.add("ocultar-seccion");document.querySelector("#contenedor-botton").classList.add("ocultar-seccion");document.querySelector("#seccion-modificar1").classList.remove("ocultar-seccion")})}function regresarModificar1(){document.querySelector("#regresar-menuModificar1").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#seccion-modificar1").classList.add("ocultar-seccion"),document.querySelector("#numero-tarjeta-modificar1").value=null,document.querySelector("#pin-modificar1").value=null})}function validarCuentaModificar(){document.querySelector("#aceptar-modificar1").addEventListener("click",e=>{if(e.preventDefault(),console.log("listo"),numeroTarjetaModificar1=document.querySelector("#numero-tarjeta-modificar1").value,pinModificar1=document.querySelector("#pin-modificar1").value,obtenerClienteId(),""==numeroTarjetaModificar1||""==pinModificar1)tipomensajeModificar1="error",tipoErrorModificar1="campos",alertaModificar1();else if(pinModificar1.length>4||pinModificar1.length<4)tipomensajeModificar1="error",tipoErrorModificar1="pin",alertaModificar1();else if(numeroTarjetaModificar1.length<9||numeroTarjetaModificar1.length>9)tipomensajeModificar1="error",tipoErrorModificar1="numero-tarjeta",alertaModificar1();else if(conectarAjaxValidarNumero1(),"numero-repetido"!==tipoErrorModificar1&&alertaModificar1(),"numero-repetido"==tipoErrorModificar1){document.querySelector("#seccion-modificar1").classList.add("ocultar-seccion");document.querySelector("#seccion-modificar").classList.remove("ocultar-seccion")}tipoErrorModificar1=""})}function conectarAjaxValidarNumero1(){const e=new XMLHttpRequest;e.open("GET","Controlador/crearCuenta/validarNumero.php",!1),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const e=JSON.parse(this.responseText);console.log(e),e.forEach(e=>{e.NumeroTarjeta==numeroTarjetaModificar1&&(tipoErrorModificar1="numero-repetido",clienteId=e.clienteId)})}},e.send()}function alertaModificar1(){const e=document.createElement("DIV");e.classList.add("contenedor-mensaje");const r=document.createElement("P");"error"==tipomensajeModificar1&&"campos"==tipoErrorModificar1?(r.textContent="Debe rellenar todos los campos",r.classList.add("no-crear")):"error"==tipomensajeModificar1&&"pin"==tipoErrorModificar1?(r.textContent="El pin debe de ser de 4 dígitos",r.classList.add("no-crear")):"error"==tipomensajeModificar1&&"numero-tarjeta"==tipoErrorModificar1?(r.textContent="El número de tarjeta debe de ser de 9 dígitos",r.classList.add("no-crear")):"error"==tipomensajeModificar1&&"numero-repetido"!=tipoErrorModificar1&&(r.textContent="Esa cuenta no existe",r.classList.add("no-crear")),e.appendChild(r);document.querySelector("#mensaje-modificar1").appendChild(e),setTimeout(()=>{e.remove()},3e3)}let numeroTarjetaModificar,nombreModificar,apellidoPaternoModificar,apellidoMaternoModificar,fechaExpiracionModificar,pinModificar,saldoModificar,contenedorModificar,tipomensajeModificar="",tipoErrorModificar="";function validarModificar(){document.querySelector("#aceptar-modificar").addEventListener("click",e=>{if(e.preventDefault(),console.log("listo"),nombreModificar=document.querySelector("#nombre-modificar").value,apellidoPaternoModificar=document.querySelector("#apellidoP-modificar").value,apellidoMaternoModificar=document.querySelector("#apellidoM-modificar").value,numeroTarjetaModificar=document.querySelector("#numero-tarjeta-modificar").value,fechaExpiracionModificar=document.querySelector("#fecha-modificar").value,pinModificar=document.querySelector("#pin-modificar").value,saldoModificar=document.querySelector("#saldo-modificar").value,""==nombreModificar||""==apellidoPaternoModificar||""==apellidoMaternoModificar||""==numeroTarjetaModificar||""==fechaExpiracionModificar||""==pinModificar||""==saldoModificar)tipomensajeModificar="error",tipoErrorModificar="campos",alertaModificar();else if(pinModificar.length>4||pinModificar.length<4)tipomensajeModificar="error",tipoErrorModificar="pin",alertaModificar();else if(numeroTarjetaModificar.length<9||numeroTarjetaModificar.length>9)tipomensajeModificar="error",tipoErrorModificar="numero-tarjeta",alertaModificar();else if("numero-repetido"!==tipoErrorModificar&&(conectarAjaxValidarNumero(),"numero-repetido"!==tipoErrorModificar)){modificarTablas();document.querySelector("#seccion-modificar").classList.add("ocultar-seccion");document.querySelector("#cuenta-modificada").classList.remove("ocultar-seccion");const e=document.querySelector("#contenedor-parrafo-cuentaModificada");contenedorModificar=document.createElement("DIV");const r=document.createElement("P"),o=clienteId.toString();r.innerHTML=`Para el clienteId -> ${o} <br> Se ha modificado exitosamente la cuenta con valores ->\n                                    <span>${nombreModificar} ${apellidoPaternoModificar} ${apellidoMaternoModificar}</span> <br> \n                                    con numero  -> <span>${numeroTarjetaModificar}</span>, \n                                    fecha de expiración-><span>${fechaExpiracionModificar}</span>\n                                    <br> y un saldo inicial -> $${saldoModificar}`,contenedorModificar.appendChild(r),e.appendChild(contenedorModificar)}tipoErrorModificar=""})}function alertaModificar(){const e=document.createElement("DIV");e.classList.add("contenedor-mensaje");const r=document.createElement("P");"error"==tipomensajeModificar&&"campos"==tipoErrorModificar?(r.textContent="Debe rellenar todos los campos",r.classList.add("no-crear")):"error"==tipomensajeModificar&&"pin"==tipoErrorModificar?(r.textContent="El pin debe de ser de 4 dígitos",r.classList.add("no-crear")):"error"==tipomensajeModificar&&"numero-tarjeta"==tipoErrorModificar?(r.textContent="El número de tarjeta debe de ser de 9 dígitos",r.classList.add("no-crear")):"error"==tipomensajeModificar&&"numero-repetido"==tipoErrorModificar&&(r.textContent="Ese número de tarjeta ya existe",r.classList.add("no-crear")),e.appendChild(r);document.querySelector("#mensaje-modificar").appendChild(e),setTimeout(()=>{e.remove()},3e3)}function modificarTablas(){nombreModificar=`'${nombreModificar}'`,apellidoPaternoModificar=`'${apellidoPaternoModificar}'`,apellidoMaternoModificar=`'${apellidoMaternoModificar}'`;for(let e=0;e<2;e++)fechaExpiracionModificar=fechaExpiracionModificar.replace("-","/");fechaExpiracionModificar=`'${fechaExpiracionModificar}'`,console.log(fechaExpiracionModificar),clienteId=clienteId.toString(),console.log(clienteId);const e=new XMLHttpRequest;e.open("GET","Controlador/modificarCuenta/modificarCuenta.php?NumeroTarjeta="+numeroTarjetaModificar+"&pin="+pinModificar+"&FechaExpiracion="+fechaExpiracionModificar+"&saldo="+saldoModificar+"&clienteId="+clienteId+"&administradorId="+administradorId+"&nombre="+nombreModificar+"&apellido_paterno="+apellidoPaternoModificar+"&apellido_materno="+apellidoMaternoModificar,!0),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&console.log("Datos enviados")},e.send()}function aceptarCuentaModificada(){document.querySelector("#botton-aceptarModificar").addEventListener("click",e=>{e.preventDefault();document.querySelector("#operaciones-administrativo").classList.remove("ocultar-seccion");document.querySelector("#contenedor-botton").classList.remove("ocultar-seccion");document.querySelector("#cuenta-modificada").classList.add("ocultar-seccion"),contenedorModificar.remove(),document.querySelector("#numero-tarjeta-modificar").value=null,document.querySelector("#nombre-modificar").value=null,document.querySelector("#apellidoP-modificar").value=null,document.querySelector("#apellidoM-modificar").value=null,document.querySelector("#pin-modificar").value=null,document.querySelector("#saldo-modificar").value=null,document.querySelector("#fecha-modificar").value=null})}function regresarModificar(){document.querySelector("#regresar-menuModificar").addEventListener("click",e=>{e.preventDefault();document.querySelector("#seccion-modificar1").classList.remove("ocultar-seccion");document.querySelector("#seccion-modificar").classList.add("ocultar-seccion"),document.querySelector("#numero-tarjeta-modificar1").value=null,document.querySelector("#pin-modificar1").value=null})}
//# sourceMappingURL=bundle.js.map
